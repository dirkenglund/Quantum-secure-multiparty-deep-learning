n=784/2;
Accuracies = [9.98, 10.47, 9.83, 10.39, 11.08, 9.98, 10.08, 10.13, 10.0, 9.96, 10.29, 10.8, 10.09, 10.03, 10.24, 10.03, 10.03, 9.94, 10.13, 10.27, 10.33, 9.65, 10.46, 10.4, 10.26, 10.23, 10.7, 10.01, 10.09, 10.4, 11.17, 10.16, 10.0, 10.72, 10.2, 10.1, 9.58, 9.56, 10.19, 10.65, 10.27, 10.88, 10.26, 10.56, 10.41, 10.52, 10.34, 10.83, 10.04, 10.77, 10.42, 10.93, 10.27, 10.68, 10.6, 10.89, 10.77, 9.96, 10.47, 10.44, 10.93, 10.81, 11.04, 10.77, 10.73, 10.48, 10.72, 10.68, 10.13, 10.84, 10.3, 10.47, 10.99, 10.57, 10.94, 10.84, 10.63, 10.94, 11.14, 11.1, 10.94, 10.85, 10.82, 11.45, 11.4, 10.74, 10.66, 10.94, 10.95, 10.87, 11.61, 11.46, 10.96, 11.61, 10.66, 10.49, 10.69, 11.72, 11.84, 11.57, 11.06, 11.68, 11.72, 11.31, 11.55, 11.67, 11.71, 11.72, 11.73, 11.98, 11.89, 11.61, 12.1, 11.51, 12.35, 12.4, 12.16, 12.32, 12.35, 12.28, 12.47, 12.39, 11.96, 12.54, 12.85, 12.88, 12.54, 12.69, 12.93, 12.91, 12.69, 12.78, 12.85, 13.29, 13.27, 13.5, 13.81, 13.54, 13.48, 13.55, 13.83, 14.09, 13.7, 14.28, 13.6, 14.21, 14.43, 14.26, 14.6, 14.57, 14.89, 14.72, 15.51, 15.55, 15.28, 15.39, 15.43, 15.32, 16.15, 15.96, 15.79, 15.77, 16.86, 16.29, 17.26, 16.56, 17.0, 16.81, 18.07, 18.13, 17.8, 17.24, 18.35, 18.52, 19.48, 19.41, 18.92, 20.11, 19.08, 19.94, 20.32, 20.91, 20.35, 21.12, 21.05, 21.56, 22.22, 21.67, 23.14, 22.94, 23.07, 23.78, 23.78, 24.44, 25.19, 25.19, 25.5, 26.32, 26.01, 26.88, 26.16, 26.25, 28.76, 27.89, 29.2, 29.18, 29.36, 30.75, 31.13, 31.05, 31.72, 32.74, 33.36, 32.94, 33.65, 34.38, 34.98, 35.13, 36.1, 35.8, 37.81, 37.82, 38.52, 39.02, 40.29, 40.5, 41.29, 41.51, 43.35, 43.83, 44.41, 44.53, 45.7, 46.08, 46.82, 47.43, 48.36, 48.98, 49.47, 50.84, 51.53, 51.81, 52.76, 53.7, 54.35, 54.64, 55.54, 56.53, 58.23, 58.68, 58.54, 59.93, 61.5, 61.33, 62.24, 62.32, 63.16, 63.71, 64.78, 64.83, 66.44, 67.84, 68.17, 68.61, 68.4, 70.41, 70.41, 71.21, 72.14, 73.1, 73.39, 74.89, 74.48, 75.06, 76.1, 76.21, 77.38, 77.98, 78.16, 79.23, 79.63, 79.85, 80.18, 81.16, 81.94, 81.97, 82.58, 83.34, 83.88, 84.72, 84.84, 84.89, 85.7, 85.89, 86.12, 86.51, 86.49, 87.43, 87.55, 88.03, 88.41, 88.66, 88.71, 89.25, 89.71, 90.07, 90.88, 90.87, 90.7, 91.31, 91.17, 91.52, 91.92, 91.82, 92.83, 91.89, 92.61, 92.8, 92.49, 92.42, 93.25, 93.41, 93.1, 93.93, 93.7, 93.75, 93.97, 94.22, 94.12, 94.12, 94.48, 94.5, 94.73, 94.86, 94.8, 94.91, 95.03, 95.33, 95.31, 95.47, 95.86, 95.85, 95.9, 95.82, 96.02, 95.84, 95.63, 95.97, 96.25, 96.1, 96.36, 96.41, 96.41, 96.57, 96.73, 96.51, 96.6, 96.65, 96.29, 96.55, 96.61, 96.75, 96.86, 96.88, 97.04, 96.96, 96.97, 96.99, 97.03, 96.88, 97.21, 97.14, 97.11, 97.12, 97.21, 97.22, 97.42, 97.23, 97.17, 97.31, 97.19, 97.29, 97.24, 97.42, 97.36, 97.42, 97.38, 97.41, 97.49, 97.49, 97.51, 97.63, 97.66, 97.63, 97.66, 97.69, 97.6, 97.63, 97.58, 97.56, 97.68, 97.38, 97.75, 97.71, 97.57, 97.56, 97.83, 97.72, 97.73, 97.78, 97.73, 97.83, 97.74, 97.76, 97.62, 97.76, 97.7, 97.73, 97.75, 97.88, 97.8, 97.69, 97.74, 97.8, 97.6, 97.78, 97.86, 97.96, 97.87, 97.82, 97.82, 98.05, 97.9, 97.88, 97.86, 97.96, 97.89, 97.83, 97.88, 97.82, 97.98, 97.78, 97.87, 97.87, 98.01, 97.97, 97.83, 98.0, 97.91, 97.92, 97.94, 98.01, 97.93, 98.02, 97.91, 97.91, 98.05, 97.91, 97.97, 98.02, 97.97, 98.01, 97.95, 97.89, 98.01, 98.04, 97.97, 98.01, 97.9, 98.0, 97.86, 98.03, 98.07, 98.06, 97.96, 98.0, 97.91, 98.03, 97.98, 97.98, 98.03, 97.95, 98.08, 97.92, 97.97, 98.02, 98.12, 98.09, 98.0, 97.94, 98.05, 98.01, 98.08, 98.08, 98.03, 97.98, 98.07, 97.9, 98.11, 98.12, 98.07, 97.97, 98.15, 98.08, 97.97, 97.99, 98.1, 98.04, 98.08, 98.1, 98.07, 98.0];
G = 1+logspace(-2.2,log10(2.2),length(Accuracies));
mu = logspace(-4, 1, 512);
DX2 = (2*G.^2-3*G+2)./(G.*(G-1)); %minimum at g=3.4
SNR = kron(mu,(1./DX2)');

Acc_map = logistic(params, sqrt(SNR));
figure(1)
Ploter_map(mu,G-1,Acc_map)
xlabel('Average photon occupation')
ylabel('Gain-1')
xlim([1e-2 10])
ylim([1e-2 2.2])

epsilon = (2 * G - 2) ./ G  /n;
w_leak = Leak(2*mu+1,1,epsilon);
d_leak = CCRB1(G, n, 1/sqrt(n));

figure(2)
Ploter_map(w_leak,d_leak,Acc_map)
xlim([1e-4 2e-1])
% ylim([1e-5 1e-2])

hcb=colorbar;
ylabel(hcb,[{'Classification Accuracy (%)'}],'FontSize',14)

function [] = Ploter_map(w_leak,d_leak,Acc_map)
contourLevels = [10 20 30 40 50 60 70 80 90 96];
[C,h] = contour(w_leak,d_leak,Acc_map,contourLevels);
set(h,'linewidth',2)
clabel(C,h)
view([0,90])
ax = gca;
ax.YDir = 'normal';
set(gca, 'XScale', 'log','yScale', 'log');
caxis([10, 100]);
xlabel('Weights Leakage $\mathit{I_{w_i}}$ (bits)', 'Interpreter', 'latex', 'FontSize', 14)
ylabel('Data Leakage $\mathit{I_{x_i}}$ (bits)', 'Interpreter', 'latex', 'FontSize', 14)
set(gca, 'FontSize', 14)
hcb = colorbar;
ylabel(hcb, 'Classification Accuracy (%)', 'Interpreter', 'latex', 'FontSize', 14)
set(hcb, 'FontSize', 14)
set(gca, 'FontName', 'Times New Roman')
set(hcb, 'FontName', 'Times New Roman')
grid minor
end